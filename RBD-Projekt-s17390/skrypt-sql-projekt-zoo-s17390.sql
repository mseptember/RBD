-- Created by Vertabelo (http://vertabelo.com)
-- Last modification date: 2018-04-05 12:40:18.049

-- tables
-- Table: Choroby
CREATE TABLE Choroby (
    IdChoroby integer  NOT NULL,
    NazwaChoroby varchar2(50)  NOT NULL,
    CONSTRAINT Choroby_pk PRIMARY KEY (IdChoroby)
) ;

-- Table: ChorobyZwierzat
CREATE TABLE ChorobyZwierzat (
    IdZwierzecia integer  NOT NULL,
    IdChoroby integer  NOT NULL,
    DataOd date  NOT NULL,
    DataDo date  NOT NULL,
    CONSTRAINT ChorobyZwierzat_pk PRIMARY KEY (IdZwierzecia,IdChoroby)
) ;

-- Table: Gatunki
CREATE TABLE Gatunki (
    IdGatunku integer  NOT NULL,
    NazwaG varchar2(30)  NOT NULL,
    CONSTRAINT Gatunki_pk PRIMARY KEY (IdGatunku)
) ;

-- Table: Jedzenie
CREATE TABLE Jedzenie (
    IdJedzenia integer  NOT NULL,
    NazwaJedzenia varchar2(30)  NOT NULL,
    CONSTRAINT Jedzenie_pk PRIMARY KEY (IdJedzenia)
) ;

-- Table: Karmienie
CREATE TABLE Karmienie (
    IdJedzenia integer  NOT NULL,
    GodzinaKarmienia varchar2(5)  NOT NULL,
    IdZwierzecia integer  NOT NULL,
    Ilosc integer  NOT NULL,
    CONSTRAINT Karmienie_pk PRIMARY KEY (IdJedzenia,IdZwierzecia)
) ;

-- Table: Klatki
CREATE TABLE KLATKI (
    IDKLATKI integer  NOT NULL,
    IdSektora integer  NOT NULL,
    NrKlatki integer  NOT NULL,
    CONSTRAINT Klatki_pk PRIMARY KEY (IDKLATKI)
) ;

-- Table: Pracownicy
CREATE TABLE Pracownicy (
    IdPracownika integer  NOT NULL,
    ImieP varchar2(30)  NOT NULL,
    NazwiskoP varchar2(30)  NOT NULL,
    Stanowisko varchar2(30)  NOT NULL,
    DataUrodzeniaP date  NOT NULL,
    PESEL char(11)  NOT NULL,
    CONSTRAINT Pracownicy_pk PRIMARY KEY (IdPracownika)
) ;

-- Table: Sektory
CREATE TABLE Sektory (
    IdSektora integer  NOT NULL,
    NazwaSektora varchar2(30)  NOT NULL,
    CONSTRAINT Sektory_pk PRIMARY KEY (IdSektora)
) ;

-- Table: Sprzatanie
CREATE TABLE Sprzatanie (
    GodzinaSprzatania varchar2(5)  NOT NULL,
    IdKlatki integer  NOT NULL,
    IdPracownika integer  NOT NULL,
    CONSTRAINT Sprzatanie_pk PRIMARY KEY (IdKlatki,IdPracownika)
) ;

-- Table: Zwierzeta
CREATE TABLE Zwierzeta (
    IdZwierzecia integer  NOT NULL,
    ImieZ varchar2(30)  NOT NULL,
    DataUrodzeniaZ date NULL,
    Pochodzenie varchar2(30) NULL,
    IDKLATKI integer  NOT NULL,
    ImieOjca varchar2(20) NULL,
    ImieMatki varchar2(20) NULL,
    IdPracownika integer  NOT NULL,
    IdGatunku integer  NOT NULL,
    CONSTRAINT Zwierzeta_pk PRIMARY KEY (IdZwierzecia)
) ;

-- foreign keys
-- Reference: ChorobyZwierzat_Choroby (table: ChorobyZwierzat)
ALTER TABLE ChorobyZwierzat ADD CONSTRAINT ChorobyZwierzat_Choroby
    FOREIGN KEY (IdChoroby)
    REFERENCES Choroby (IdChoroby);

-- Reference: ChorobyZwierzat_Zwierzeta (table: ChorobyZwierzat)
ALTER TABLE ChorobyZwierzat ADD CONSTRAINT ChorobyZwierzat_Zwierzeta
    FOREIGN KEY (IdZwierzecia)
    REFERENCES Zwierzeta (IdZwierzecia);

-- Reference: Karmienie_Jedzenie (table: Karmienie)
ALTER TABLE Karmienie ADD CONSTRAINT Karmienie_Jedzenie
    FOREIGN KEY (IdJedzenia)
    REFERENCES Jedzenie (IdJedzenia);

-- Reference: Karmienie_Zwierzeta (table: Karmienie)
ALTER TABLE Karmienie ADD CONSTRAINT Karmienie_Zwierzeta
    FOREIGN KEY (IdZwierzecia)
    REFERENCES Zwierzeta (IdZwierzecia);

-- Reference: Klatki_Sektory (table: Klatki)
ALTER TABLE KLATKI ADD CONSTRAINT Klatki_Sektory
    FOREIGN KEY (IdSektora)
    REFERENCES Sektory (IdSektora);

-- Reference: Sprzatanie_Klatki (table: Sprzatanie)
ALTER TABLE Sprzatanie ADD CONSTRAINT Sprzatanie_Klatki
    FOREIGN KEY (IdKlatki)
    REFERENCES Klatki (IdKlatki);

-- Reference: Sprzatanie_Pracownicy (table: Sprzatanie)
ALTER TABLE Sprzatanie ADD CONSTRAINT Sprzatanie_Pracownicy
    FOREIGN KEY (IdPracownika)
    REFERENCES Pracownicy (IdPracownika);

-- Reference: Zwierzeta_Gatunki (table: Zwierzeta)
ALTER TABLE Zwierzeta ADD CONSTRAINT Zwierzeta_Gatunki
    FOREIGN KEY (IdGatunku)
    REFERENCES Gatunki (IdGatunku);

-- Reference: Zwierzeta_Klatki (table: Zwierzeta)
ALTER TABLE Zwierzeta ADD CONSTRAINT Zwierzeta_Klatki
    FOREIGN KEY (IdKlatki)
    REFERENCES Klatki (IdKlatki);

-- Reference: Zwierzeta_Pracownicy (table: Zwierzeta)
ALTER TABLE Zwierzeta ADD CONSTRAINT Zwierzeta_Pracownicy
    FOREIGN KEY (IdPracownika)
    REFERENCES Pracownicy (IdPracownika);

-- End of file.

INSERT INTO CHOROBY (IDCHOROBY, NAZWACHOROBY) VALUES (1, 'GRYPA');
INSERT INTO CHOROBY (IDCHOROBY, NAZWACHOROBY) VALUES (2, 'RAK JELITA');
INSERT INTO CHOROBY (IDCHOROBY, NAZWACHOROBY) VALUES (3, 'BIALACZKA');
INSERT INTO CHOROBY (IDCHOROBY, NAZWACHOROBY) VALUES (4, 'TEZEC');
INSERT INTO CHOROBY (IDCHOROBY, NAZWACHOROBY) VALUES (5, 'RAK TRZUSTKI');

INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (1, 'BOB', '2010-05-10', 'AFRYKA', 1, 'KRIS', 'ANNA', 1, 1);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (2, 'ADA', '2008-03-11', 'AFRYKA', 1, 'KRIS', 'ANNA', 1, 1);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (3, 'KRIS', NULL, 'AFRYKA', 1, NULL, NULL, 1, 1);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (4, 'ANNA', NULL, 'AFRYKA', 1, NULL, NULL, 1, 1);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (5, 'MONK', '2016-06-19', 'AZJA', 2, 'PAPA', 'MOMO', 2, 2);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (6, 'MOMO', NULL, 'AZJA', 2, NULL, NULL, 2, 2);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (7, 'PAPA', NULL, 'AZJA', 2, NULL, NULL, 2, 2);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (8, 'PTAK', '2017-10-12', 'EUROPA', 3, 'KRAK', 'CRUCA', 3, 3);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (9, 'KRAK', NULL, 'EUROPA', 3, NULL, NULL, 3, 3);
INSERT INTO ZWIERZETA (IDZWIERZECIA, IMIEZ, DATAURODZENIAZ, POCHODZENIE, IDKLATKI, IMIEOJCA, IMIEMATKI, IDPRACOWNIKA, IDGATUNKU) VALUES (10, 'CRUCA', NULL, 'EUROPA', 3, NULL, NULL, 3, 3);

INSERT INTO GATUNKI (IDGATUNKU, NAZWAG) VALUES (1,'SLON AFRYKANSKI');
INSERT INTO GATUNKI (IDGATUNKU, NAZWAG) VALUES (2,'MAKAK');
INSERT INTO GATUNKI (IDGATUNKU, NAZWAG) VALUES (3,'KRUK EUROPEJSKI');

INSERT INTO SEKTORY (IDSEKTORA, NAZWASEKTORA) VALUES (1, 'SLONIARNIA');
INSERT INTO SEKTORY (IDSEKTORA, NAZWASEKTORA) VALUES (2, 'MALPIARNIA');
INSERT INTO SEKTORY (IDSEKTORA, NAZWASEKTORA) VALUES (3, 'PTASZARNIA');

INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (1, 1, 1);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (2, 1, 2);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (3, 1, 3);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (4, 2, 1);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (5, 2, 2);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (6, 2, 3);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (7, 3, 1);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (8, 3, 2);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (9, 3, 3);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (10, 1, 4);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (11, 1, 5);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (12, 1, 6);
INSERT INTO KLATKI (IDKLATKI, IDSEKTORA, NRKLATKI) VALUES (13, 3, 4);

INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('09:30', 1, 1);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('10:00', 2, 1);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('10:30', 3, 1);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('09:30', 4, 2);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('10:00', 5, 2);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('10:30', 6, 2);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('09:30', 7, 3);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('10:00', 8, 3);
INSERT INTO SPRZATANIE (GODZINASPRZATANIA, IDKLATKI, IDPRACOWNIKA) VALUES ('10:30', 9, 3);

INSERT INTO PRACOWNICY (IDPRACOWNIKA, IMIEP, NAZWISKOP, STANOWISKO, DATAURODZENIAP, PESEL) VALUES (1, 'ANDRZEJ', 'SLONIOWY', 'OPIEKUN', '1990-01-01', 90010100212);
INSERT INTO PRACOWNICY (IDPRACOWNIKA, IMIEP, NAZWISKOP, STANOWISKO, DATAURODZENIAP, PESEL) VALUES (2, 'BARBARA', 'MALPOWSKA', 'OPIEKUN', '1988-02-02', 88020200252);
INSERT INTO PRACOWNICY (IDPRACOWNIKA, IMIEP, NAZWISKOP, STANOWISKO, DATAURODZENIAP, PESEL) VALUES (3, 'MATEUSZ', 'PTASZKOWSKI', 'OPIEKUN', '1989-03-03', 89030300232);
INSERT INTO PRACOWNICY (IDPRACOWNIKA, IMIEP, NAZWISKOP, STANOWISKO, DATAURODZENIAP, PESEL) VALUES (4, 'AGNIESZKA', 'NOWAK', 'SPRZEDAWCA', '1994-04-04', 94040401212);

INSERT INTO JEDZENIE (IDJEDZENIA, NAZWAJEDZENIA) VALUES (1, 'TRAWA');
INSERT INTO JEDZENIE (IDJEDZENIA, NAZWAJEDZENIA) VALUES (2, 'BANAN');
INSERT INTO JEDZENIE (IDJEDZENIA, NAZWAJEDZENIA) VALUES (3, 'OWADY');

INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (1, '14:30', 1, 5);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (1, '14:30', 2, 4);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (1, '14:30', 3, 5);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (1, '14:30', 4, 5);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (2, '14:30', 5, 3);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (2, '14:30', 6, 3);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (2, '14:30', 7, 4);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (3, '14:30', 8, 10);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (3, '14:30', 9, 8);
INSERT INTO KARMIENIE (IDJEDZENIA, GODZINAKARMIENIA, IDZWIERZECIA, ILOSC) VALUES (3, '14:30', 10, 9);

INSERT INTO CHOROBYZWIERZAT (IDZWIERZECIA,IDCHOROBY, DATAOD, DATADO) VALUES (1, 2, '2017-05-18', '2017-06-18');
INSERT INTO CHOROBYZWIERZAT (IDZWIERZECIA,IDCHOROBY, DATAOD, DATADO) VALUES (2, 3, '2016-03-01', '2016-04-15');
INSERT INTO CHOROBYZWIERZAT (IDZWIERZECIA,IDCHOROBY, DATAOD, DATADO) VALUES (3, 1, '2014-12-03', '2014-12-17');
INSERT INTO CHOROBYZWIERZAT (IDZWIERZECIA,IDCHOROBY, DATAOD, DATADO) VALUES (8, 5, '2017-04-12', '2017-04-20');
INSERT INTO CHOROBYZWIERZAT (IDZWIERZECIA,IDCHOROBY, DATAOD, DATADO) VALUES (5, 4, '2017-10-18', '2018-03-15');
INSERT INTO CHOROBYZWIERZAT (IDZWIERZECIA,IDCHOROBY, DATAOD, DATADO) VALUES (1, 1, '2015-07-19', '2015-08-01');
INSERT INTO CHOROBYZWIERZAT (IDZWIERZECIA,IDCHOROBY, DATAOD, DATADO) VALUES (1, 4, '2016-10-22', '2016-11-03');

commit;

--POLECENIA SELECT

--1 WYŒWIETLA IMIONA ZWIERZ¥T, U KTÓRYCH NIE ZNAMY OJCA/MATKI
SELECT IMIEZ FROM ZWIERZETA WHERE ImieOjca IS NULL OR ImieMatki IS NULL;

--2 WYŒWIETLA IMIE I PESEL PRACOWNIKÓW, KTÓRZY S¥ OPIEKUNAMI ZWIERZ¥T
SELECT IMIEP, PESEL FROM PRACOWNICY WHERE STANOWISKO = 'OPIEKUN';

--3 WYŒWIETLA ILOŒÆ JEDZENIA, KTÓRE JE DZIENNIE ZWIERZÊ O ID=1
SELECT ILOSC FROM KARMIENIE WHERE IDZWIERZECIA = 1;

--4 WYŒWIETLA IMIONA ZWIERZ¥T. KTÓRYCH OPIEKUNEM JEST PRACOWNIK O ID=2
SELECT IMIEZ FROM ZWIERZETA WHERE IDPRACOWNIKA = 2;

--5 WYŒWIETLA NR KLATEK W SEKTORZE 3
SELECT NRKLATKI FROM KLATKI WHERE IDSEKTORA = 3;

--6 WYŒWIETLA NAZWY CHORÓB/NAZWÊ CHOROBY KTÓR¥ MIALO ZWIERZÊ O ID=1
SELECT NAZWACHOROBY FROM CHOROBY c JOIN CHOROBYZWIERZAT cz ON c.IDCHOROBY = cz.IDCHOROBY
WHERE IDZWIERZECIA = 1;

--7 WYŒWIETLA NAZWÊ I ILOŒÆ JEDZENIA KTÓRE JE ZWIERZÊ O ID=8
SELECT NAZWAJEDZENIA, ILOSC FROM KARMIENIE k JOIN JEDZENIE j ON k.IDJEDZENIA = j.IDJEDZENIA
WHERE IDZWIERZECIA = 8;

--8 WYŒWIETLA IMIONA ZWIERZ¥T, KTÓRE S¥ MAKAKAMI
SELECT IMIEZ FROM ZWIERZETA z JOIN GATUNKI g ON z.IDGATUNKU = g.IDGATUNKU
WHERE NazwaG = 'MAKAK';

--9 WYŒWIETLA IMIONA I NAZWISKA PRACOWNIKÓW KTÓRZY SPRZ¥TAJ¥ KLATKÊ O ID=1 LUB O ID=5
SELECT IMIEP, NAZWISKOP FROM PRACOWNICY p JOIN SPRZATANIE s ON p.IDPRACOWNIKA = s.IDPRACOWNIKA
WHERE IDKLATKI = 1 OR IDKLATKI = 5;

--10 WYŒWIETLA IMIE ZWIERZÊCIA, DATÊ OD I DO KIEDY BYLO CHORÊ ORAZ NAZWÊ CHOROBY,
-- DLA WSZYSTKICH ZWIERZ¥T KTÓRE POCHODZ¥ Z AFRYKI
SELECT IMIEZ, DATAOD, DATADO, ch.NAZWACHOROBY FROM CHOROBYZWIERZAT cz
JOIN ZWIERZETA z ON z.IDZWIERZECIA = cz.IDZWIERZECIA
JOIN CHOROBY ch ON cz.IDCHOROBY = ch.IDCHOROBY
WHERE POCHODZENIE = 'AFRYKA';

--11 WYŒWIETLA ILE ZWIERZ¥T POCHODZI Z POSZCZEGÓLNYCH KONTYNENTÓW
SELECT POCHODZENIE, COUNT(1) FROM ZWIERZETA GROUP BY POCHODZENIE;

--12 WYŒWIETLA MAKSYMALN¥ ILOŒÆ JEDZENIA KTÓR¥ ZJADA ZWIERZÊ Z DANEGO KONTYNENTU, ALE TYLKO DLA ILOSCI > 5
SELECT POCHODZENIE, MAX(ILOSC) FROM ZWIERZETA z JOIN KARMIENIE k ON z.IDZWIERZECIA = k.IDZWIERZECIA
GROUP BY POCHODZENIE HAVING MAX(ILOSC) > 5;

--13 WYSWIETLA ILOSC PRACOWNIKOW NA DANYM STANOWISKU
SELECT STANOWISKO, COUNT(1) FROM PRACOWNICY GROUP BY STANOWISKO;

--14 WYŒWIETLA IMIÊ ZWIERZÊCIA I JEGO DATÊ ZAKOÑCZENIA JEGO OSTATNIEJ CHOROBY, ALE TYLKO DLA ZWIERZ¥T KTÓRE BYLY CHORE WIÊCEJ NI¯ 1 RAZ
SELECT IMIEZ, MAX(DATADO) FROM ZWIERZETA z JOIN CHOROBYZWIERZAT c ON z.IDZWIERZECIA = c.IDZWIERZECIA
GROUP BY IMIEZ HAVING COUNT(c.IDZWIERZECIA)>1;

--15 WYSWIETLA NAZWÊ CHOROBY I ILE RAZY WYSTÊPOWALA, ALE TYLKO JE¯ELI WYSTÊPOWALA WIÊCEJ NI¯ 1 RAZ
SELECT NAZWACHOROBY "Nazwa Choroby", COUNT(1) "Ile razy wyst¹pila?" FROM CHOROBY ch JOIN CHOROBYZWIERZAT cz ON ch.IDCHOROBY = cz.IDCHOROBY
GROUP BY NAZWACHOROBY HAVING COUNT(1) > 1;